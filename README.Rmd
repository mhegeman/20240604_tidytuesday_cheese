---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  echo = FALSE,
  comment = "#>"
)
library(tidyverse)
library(janitor)
library(maps)
library(gt)
source("R/cheese.R")
```

# Tidy Tuesday - National Cheese Day

<!-- badges: start -->
<!-- badges: end -->

This week's Tidy Tuesday data set is about cheese! ðŸ§€

Cheese.com has information on over 1,000 cheeses from around the world. This data set includes information on the name, country of origin, texture, and type of milk used for each cheese.

## Cleaning the dataset

Tidy Tuesday provided two data tables to work with: `cheeses.csv` and `cheese_details.csv`. 

## Cheeses of the World


```{r cheese_map}

world_map <- map_data("world") %>%
  mutate(region = if_else(!is.na(subregion) & region == "United Kingdom", subregion, region)) %>%
  mutate(region = case_when(
    region == "USA" ~ "United States",
    region == "UK" ~ "United Kingdom",
    TRUE ~ region
  ))

cheese_map <- world_map %>%
  left_join(cheese_by_country, by = c("region" = "country")) 


# no_match <- cheese_by_country %>%
#   filter(!country %in% world_map$region)

cheese_map_plot <- ggplot(cheese_map, aes(x = long, y = lat, group = group)) +
  geom_polygon(aes(fill = count), color = "white") +
  coord_fixed(1.3) +
  scale_x_continuous(limits = c(-180, 180)) +
  scale_y_continuous(limits = c(-60, 90)) +
  theme_minimal() +
  scale_fill_viridis_c() +
  labs(
    title = "Numbers of Cheese by Country",
    fill = "Cheese Count",
    x = "",
    y = ""
  )


plot(cheese_map_plot)


```



```{r texture}
# get the top ten textures from cheese_texture

top_five_texture <- cheese_texture %>% 
  slice_max(count, n = 5) 

common_texture_string <- str_c(top_five_texture$texture, collapse = ", ")
```

The most common types of descriptors for cheese texture in this data set include `r common_texture_string`. 

```{r texture table}

cheese_texture %>%
  filter(!is.na(texture)) %>%
  mutate(texture = str_to_title(texture)) %>%
  gt() %>% 
  tab_header(title = md("**Most Popular Cheese Descriptions**"),
             subtitle = "Number of times each phrase shows up in the data set") %>% 
  cols_label(texture = "Texture", 
             count = "Number of References")

```

```{r milk}

cheese_milk %>%
  filter(!is.na(milk)) %>% 
  mutate(milk = str_to_title(milk)) %>%
  gt() %>% 
  tab_header(title = md("**Most Popular Milk Types**"),
             subtitle = "Number of cheeses using each milk.") %>% 
  cols_label(milk = "Milk Type", 
             count = "Number of Cheeses")


```


